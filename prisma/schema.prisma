// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "sqlite"
  // url      = env("DATABASE_URL")
  url      = "file:./db.sqlite"
}

generator clientRs {
  provider = "cargo prisma"
  output   = "./src/prisma.rs"
}

generator clientTs {
  provider = "prisma-client-js"
}

// model Template {
//     id    Int    @id @default(autoincrement())
//
//     updatedAt DateTime @updatedAt
//     createdAt DateTime @default(now())
// }

model User {
  id Int @id @default(autoincrement())

  username String
  email    String @unique
  password String

  whiteGames   Game[]        @relation("playerWhite")
  blackGames   Game[]        @relation("playerBlack")
  gameMessages GameMessage[]

  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
}

model Game {
  id Int @id @default(autoincrement())

  playerWhiteId Int?
  playerWhite   User? @relation(name: "playerWhite", fields: [playerWhiteId], references: [id])
  playerBlackId Int?
  playerBlack   User? @relation(name: "playerBlack", fields: [playerBlackId], references: [id])

  messages GameMessage[]

  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
}

model GameMessage {
  id Int @id @default(autoincrement())

  author   User @relation(fields: [authorId], references: [id])
  authorId Int

  game   Game @relation(fields: [gameId], references: [id])
  gameId Int

  message String

  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
}
